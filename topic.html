<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Rabbi's Garden offers biblical teachings and sermons to nourish your spiritual life.">
  <title>Rabbi's Garden - Topic</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Poppins:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <style>
    /* Global Styles */
    :root {
      --primary-green: #1e8449;
      --dark-green: #145a32;
      --light-green: #58d68d;
      --gold-accent: #f1c40f;
      --pure-white: #ffffff;
      --off-white: #f8f9fa;
      --dark-bg: #1a1a1a;
      --text-dark: #333333;
      --transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      color: var(--text-dark);
      line-height: 1.6;
      background-color: var(--pure-white);
      scroll-behavior: smooth;
      overflow-x: hidden;
      font-size: 0.95rem;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Montserrat', sans-serif;
      color: var(--light-green);
      font-weight: 700;
      letter-spacing: -0.5px;
    }

    a {
      text-decoration: none;
      color: var(--primary-green);
      transition: var(--transition);
    }

    a:hover {
      color: var(--light-green);
    }

    .container {
      width: 100%;
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 15px;
    }

    section {
      padding: 60px 0;
      position: relative;
    }

    .btn {
      display: inline-block;
      background-color: var(--primary-green);
      color: white;
      padding: 12px 28px;
      border: none;
      border-radius: 50px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 3px 12px rgba(30, 132, 73, 0.3);
      position: relative;
      overflow: hidden;
    }

    .btn:hover {
      background-color: var(--light-green);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(88, 214, 141, 0.4);
    }

    .btn:active {
      transform: translateY(1px);
    }

    .btn::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transform: translateX(-100%);
      transition: 0.5s;
      pointer-events: none;
    }

    .btn:hover::after {
      transform: translateX(100%);
    }

    /* Navigation */
    nav {
      background-color: var(--pure-white);
      box-shadow: 0 3px 15px rgba(0,0,0,0.08);
      position: sticky;
      top: 0;
      z-index: 1000;
      transition: var(--transition);
    }

    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.8rem 1.5rem;
    }

    .logo {
      font-family: 'Montserrat', sans-serif;
      font-weight: 900;
      font-size: 1.4rem;
      color: var(--primary-green);
      text-decoration: none;
      display: flex;
      align-items: center;
      transition: var(--transition);
    }

    .logo:hover {
      transform: scale(1.02);
    }

    .logo-img {
      height: 40px;
      margin-right: 10px;
    }

    .nav-links {
      display: flex;
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .nav-links li {
      margin-left: 1.8rem;
    }

    .nav-links a {
      text-decoration: none;
      color: var(--text-dark);
      font-weight: 600;
      transition: var(--transition);
      position: relative;
      padding: 4px 0;
      font-size: 0.95rem;
    }

    .nav-links a.active {
      color: var(--primary-green);
    }

    .nav-links a:hover {
      color: var(--primary-green);
    }

    .nav-links a:after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: 0;
      left: 0;
      background-color: var(--primary-green);
      transition: var(--transition);
      border-radius: 2px;
    }

    .nav-links a:hover:after,
    .nav-links a.active:after {
      width: 100%;
    }

    /* Hamburger menu for mobile */
    .hamburger {
      display: none;
      cursor: pointer;
      font-size: 1.5rem;
      color: var(--primary-green);
      transition: var(--transition);
    }

    .hamburger:hover {
      transform: rotate(90deg);
    }

    /* Header Section */
    header {
      background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                  url('https://i.pinimg.com/736x/d9/42/e6/d942e6583e3661c5ea62070ce9300189.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      height: 60vh;
      min-height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .header-content {
      max-width: 700px;
      padding: 0 20px;
      animation: fadeInUp 1s ease-out;
      z-index: 2;
    }

    header h1 {
      font-size: clamp(2rem, 5vw, 3rem);
      margin: 0 0 20px;
      color: white;
      text-shadow: 0 2px 8px rgba(0,0,0,0.5);
      line-height: 1.2;
      position: relative;
      display: inline-block;
    }

    header h1::after {
      content: '';
      position: absolute;
      bottom: -12px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: var(--light-green);
      border-radius: 2px;
    }

    header p {
      font-size: clamp(0.9rem, 2vw, 1.1rem);
      margin: 30px 0;
      color: rgba(255,255,255,0.9);
      font-weight: 300;
      line-height: 1.5;
    }

    /* Topic Article Page Styles */
    .topic-article {
      padding: 40px 0;
      max-width: 800px;
      margin: 0 auto;
    }

    .topic-article img {
      width: 100%;
      height: 300px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 30px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .topic-article h2 {
      font-size: 2.2rem;
      margin-bottom: 20px;
      color: var(--primary-green);
    }

    .topic-article h4 {
      font-size: 1.4rem;
      margin: 25px 0 15px;
      color: var(--dark-green);
    }

    .topic-article p, .topic-article ul {
      margin-bottom: 20px;
      line-height: 1.7;
    }

    .topic-article ul {
      padding-left: 20px;
    }

    .topic-article li {
      margin-bottom: 10px;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      margin-bottom: 30px;
      color: var(--primary-green);
      font-weight: 600;
      transition: var(--transition);
    }

    .back-link:hover {
      color: var(--light-green);
      transform: translateX(-4px);
    }

    /* Loading Animation */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 60px 0;
    }

    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(30, 132, 73, 0.2);
      border-radius: 50%;
      border-top: 4px solid var(--primary-green);
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Error Message */
    .error-message {
      text-align: center;
      padding: 60px 0;
      color: #666;
    }

    .error-message h2 {
      margin-bottom: 20px;
    }

    /* Footer */
    footer {
      background-color: var(--dark-bg);
      color: white;
      padding: 60px 0 25px;
    }

    .footer-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 35px;
      margin-bottom: 40px;
    }

    .footer-logo-container {
      display: flex;
      align-items: center;
      margin-bottom: 1.2rem;
    }

    .footer-logo-img {
      height: 35px;
      margin-right: 10px;
    }

    .footer-logo-text {
      font-family: 'Montserrat', sans-serif;
      font-weight: 900;
      font-size: 1.5rem;
      color: var(--pure-white);
    }

    .footer-about p {
      margin-bottom: 1.2rem;
      color: #aaa;
      line-height: 1.6;
      font-size: 0.9rem;
      max-width: 300px;
    }

    .footer-links h3, .footer-social h3 {
      color: var(--pure-white);
      margin-bottom: 1.5rem;
      font-size: 1.1rem;
      position: relative;
      padding-bottom: 8px;
    }

    .footer-links h3:after, .footer-social h3:after {
      content: '';
      position: absolute;
      left: 0;
      bottom: 0;
      width: 40px;
      height: 2px;
      background-color: var(--gold-accent);
    }

    .footer-links ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .footer-links li {
      margin-bottom: 0.8rem;
    }

    .footer-links a {
      color: #aaa;
      text-decoration: none;
      transition: var(--transition);
      display: inline-block;
      font-size: 0.9rem;
    }

    .footer-links a:hover {
      color: var(--light-green);
      transform: translateX(4px);
    }

    .social-icons {
      display: flex;
      gap: 1rem;
    }

    .social-icons a {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 38px;
      height: 38px;
      background-color: transparent;
      border-radius: 50%;
      color: var(--light-green);
      border: 2px solid var(--light-green);
      transition: var(--transition);
      font-size: 1rem;
    }

    .social-icons a:hover {
      background-color: var(--light-green);
      color: var(--dark-bg);
      transform: translateY(-3px) scale(1.08);
    }

    .footer-bottom {
      text-align: center;
      padding-top: 25px;
      border-top: 1px solid #333;
      color: #777;
      font-size: 0.85rem;
    }

    .footer-bottom a {
      color: var(--light-green);
      font-weight: 600;
    }

    /* Scroll to Top Button */
    .scroll-to-top {
      position: fixed;
      bottom: 25px;
      right: 25px;
      width: 42px;
      height: 42px;
      background-color: var(--primary-green);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: var(--transition);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .scroll-to-top.active {
      opacity: 1;
      visibility: visible;
    }

    .scroll-to-top:hover {
      background-color: var(--light-green);
      transform: translateY(-3px);
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .nav-container {
        padding: 0.8rem;
      }
      
      header h1::after {
        width: 50px;
        height: 3px;
        bottom: -10px;
      }
    }

    @media (max-width: 768px) {
      .nav-links {
        display: none;
        position: absolute;
        top: 70px;
        left: 0;
        width: 100%;
        background-color: var(--pure-white);
        flex-direction: column;
        padding: 1.2rem 0;
        box-shadow: 0 8px 15px rgba(0,0,0,0.1);
      }

      .nav-links.show {
        display: flex;
      }

      .nav-links li {
        margin: 0;
        text-align: center;
        padding: 0.7rem 0;
      }

      .hamburger {
        display: block;
      }

      .btn {
        padding: 10px 25px;
        font-size: 0.9rem;
      }
      
      section {
        padding: 50px 0;
      }
      
      .scroll-to-top {
        width: 38px;
        height: 38px;
        font-size: 16px;
        bottom: 20px;
        right: 20px;
      }
      
      header {
        min-height: 350px;
      }
      
      .topic-article h2 {
        font-size: 1.8rem;
      }
      
      .topic-article h4 {
        font-size: 1.3rem;
      }
    }

    @media (max-width: 576px) {
      .nav-container {
        padding: 0.7rem;
      }
      
      .logo {
        font-size: 1.3rem;
      }
      
      .logo-img {
        height: 35px;
        margin-right: 8px;
      }
      
      .footer-container {
        grid-template-columns: 1fr;
        gap: 25px;
      }
      
      .header-content {
        padding: 0 15px;
      }
      
      header h1::after {
        width: 40px;
        height: 2px;
        bottom: -8px;
      }
      
      .footer-logo-img {
        height: 30px;
      }
      
      .footer-logo-text {
        font-size: 1.3rem;
      }
      
      .topic-article {
        padding: 30px 15px;
      }
      
      .topic-article h2 {
        font-size: 1.6rem;
      }
      
      .topic-article h4 {
        font-size: 1.2rem;
      }
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav>
    <div class="nav-container container">
      <a href="index.html" class="logo">
        <img src="Photos/logo.png.png" alt="Rabbi's Garden" class="logo-img">
        <span>Rabbi's Garden</span>
      </a>
      <div class="hamburger">â˜°</div>
      <ul class="nav-links" id="nav-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="donations.html">Donations</a></li>
        <li><a href="sermons.html">Sermons</a></li>
        <li><a href="shop.html">Shop</a></li>
        <li><a href="contacts.html">Contacts</a></li>
        <li><a href="faq.html">FAQ</a></li>
      </ul>
    </div>
  </nav>

  <!-- Header -->
  <header id="topicHeader">
    <div class="header-content">
      <h1 id="topicTitle">Topic Title</h1>
      <p id="topicDescription">Topic description will appear here</p>
    </div>
  </header>

  <!-- Topic Article Content -->
  <section class="topic-article">
    <div class="container">
      <a href="sermons.html" class="back-link">
        <i class="fas fa-arrow-left"></i> Back to Topics
      </a>
      <div id="topicContent">
        <div class="loading">
          <div class="loading-spinner"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-container">
        <div class="footer-about">
          <div class="footer-logo-container">
            <img src="Photos/logo.png.png" alt="Rabbi's Garden" class="footer-logo-img">
            <span class="footer-logo-text">Rabbi's Garden</span>
          </div>
          <p>A community-based initiative dedicated to sharing the transformative power of the Bible with the world.</p>
          <p>Join Us in Spreading the Word: Become a Part of Our Bible Community!</p>
        </div>
        
        <div class="footer-links">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="donations.html">Donations</a></li>
            <li><a href="sermons.html">Sermons</a></li>
            <li><a href="shop.html">Shop</a></li>
            <li><a href="contacts.html">Contacts</a></li>
            <li><a href="faq.html">FAQ</a></li>
          </ul>
        </div>
        
        <div class="footer-social">
          <h3>Connect With Us</h3>
          <div class="social-icons">
            <a href="https://www.instagram.com/rabbisgarden/?hl=en" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
            <a href="https://www.tiktok.com/@rabbis.garden" aria-label="Tiktok"><i class="fab fa-tiktok"></i></a>
            <a href="https://www.youtube.com/@mikewuertemburg2204" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
          </div>
          <p style="margin-top: 1.2rem; color: #aaa;">Follow our journey and see the impact of your support.</p>
        </div>
      </div>
      
      <div class="footer-bottom">
        <p>&copy; <span id="current-year"></span> Rabbi's Garden. All rights reserved. | <a href="privacy.html">Privacy Policy</a> | <a href="terms.html">Terms & Conditions</a></p>
      </div>
    </div>
  </footer>

  <!-- Scroll to Top Button -->
  <div class="scroll-to-top" id="scrollToTop">
    <i class="fas fa-arrow-up"></i>
  </div>

<!-- JavaScript -->
<script>
  // Google Sheets CSV URL (published)
  const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTvzt1i_Q8hqH39YKXl5V4n6d-r1e3xJ_Y6IsxSLxof5TtGN55oHx_kzwUm51GzZiQzL8lNB-wPEOln/pub?output=csv';
  
  // CORS proxy
  const CORS_PROXY = 'https://api.allorigins.win/raw?url=';

  // Set current year in footer
  document.getElementById('current-year').textContent = new Date().getFullYear();

  // Navbar Scroll Effect
  window.addEventListener('scroll', () => {
    const nav = document.querySelector('nav');
    nav.style.boxShadow = window.scrollY > 50 
      ? '0 8px 25px rgba(0, 0, 0, 0.15)'
      : '0 3px 15px rgba(0,0,0,0.08)';
  });

  // Set active navigation link
  document.addEventListener('DOMContentLoaded', () => {
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    const navLinks = document.querySelectorAll('.nav-links a');
    navLinks.forEach(link => {
      link.classList.toggle('active', currentPage === link.getAttribute('href'));
    });

    // Load topic content
    loadTopicContent();
  });

  // Mobile menu toggle
  document.querySelector('.hamburger').addEventListener('click', () => {
    document.getElementById('nav-menu').classList.toggle('show');
  });

  // Close menu when clicking a link
  document.querySelectorAll('#nav-menu a').forEach(link => {
    link.addEventListener('click', () => {
      document.getElementById('nav-menu').classList.remove('show');
    });
  });

  // Scroll to Top Button
  const scrollToTopBtn = document.getElementById('scrollToTop');
  window.addEventListener('scroll', () => {
    scrollToTopBtn.classList.toggle('active', window.pageYOffset > 300);
  });
  scrollToTopBtn.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  // Load topic content from Google Sheets
  async function loadTopicContent() {
    try {
      const urlParams = new URLSearchParams(window.location.search);
      const topicId = urlParams.get('id');
      if (!topicId) {
        showError('Topic not specified');
        return;
      }

      const response = await fetch(CORS_PROXY + encodeURIComponent(SHEET_URL));
      if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
      const csvData = await response.text();
      const topics = parseCSV(csvData);

      // Find the topic by ID
      const topic = topics.find(t => t.id === topicId);
      if (!topic) {
        showError('Topic not found');
        return;
      }

      // Update page content
      document.getElementById('topicTitle').textContent = topic.title;
      document.getElementById('topicDescription').textContent = topic.summary || 'Explore this topic';
      document.title = `Rabbi's Garden - ${topic.title}`;

      // Set header background image
      document.getElementById('topicHeader').style.backgroundImage = 
        `linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('${topic.thumbnail || 'https://i.pinimg.com/736x/d9/42/e6/d942e6583e3661c5ea62070ce9300189.jpg'}')`;

      // Embed content from preview_url
      if (topic.preview_url) {
        document.getElementById('topicContent').innerHTML = `
          <iframe src="${topic.preview_url}" 
                  width="100%" 
                  height="800px" 
                  style="border:none;">
          </iframe>
        `;
      } else {
        document.getElementById('topicContent').innerHTML = '<p>Content for this topic is coming soon. Please check back later.</p>';
      }

    } catch (error) {
      console.error('Error loading topic content:', error);
      showError('Unable to load content');
    }
  }

  // CSV parsing function
  function parseCSV(csv) {
    const lines = csv.split('\n');
    const result = [];
    const headers = lines[0].split(',').map(h => h.trim().toLowerCase()); // lowercase headers

    for (let i = 1; i < lines.length; i++) {
      if (!lines[i].trim()) continue;
      const obj = {};
      let inQuotes = false, currentField = '', fieldIndex = 0;
      const line = lines[i];

      for (let j = 0; j < line.length; j++) {
        const char = line[j];
        if (char === '"' && (j === 0 || line[j-1] !== '\\')) {
          inQuotes = !inQuotes;
        } else if (char === ',' && !inQuotes) {
          obj[headers[fieldIndex]] = currentField.trim();
          currentField = '';
          fieldIndex++;
        } else {
          currentField += char;
        }
      }
      obj[headers[fieldIndex]] = currentField.trim();
      result.push(obj);
    }
    return result;
  }

  // Show error message
  function showError(message) {
    document.getElementById('topicContent').innerHTML = `
      <div class="error-message">
        <h2>${message}</h2>
        <p>Please try again later or <a href="sermons.html">browse other topics</a>.</p>
      </div>
    `;
  }
</script>
</body>
</html>